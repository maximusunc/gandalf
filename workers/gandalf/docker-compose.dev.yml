# Development compose file for running the Gandalf worker with local source.
#
# Usage:
#   docker compose -f docker-compose.dev.yml up --build
#
# Adjust paths below to match your local setup:
#   - gandalf-src: path to your local Gandalf repo
#   - graph volume: path to your mmap graph directory

services:
  gandalf:
    build:
      context: ../../  # Shepherd repo root
      dockerfile: workers/gandalf/Dockerfile.dev
      additional_contexts:
        gandalf-src: ../../../gandalf  # path to local Gandalf repo
    volumes:
      - ${GANDALF_GRAPH_PATH:-./graph}:/app/graph:ro
    environment:
      - GANDALF_GRAPH_PATH=/app/graph
      - GANDALF_GRAPH_FORMAT=auto
      - GANDALF_DEBUG_RESPONSES=true
